<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Real-Time Chat Application</title>
  <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.1/stomp.min.js"></script>

  <style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .container {
        max-width: 700px;
    }

    h1 {
        color: #ffffff;
        font-weight: 700;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
    }

    .chat-container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    #chat {
        background: linear-gradient(to bottom, #f8f9fa 0%, #e9ecef 100%);
        border: none;
        border-radius: 15px;
        padding: 20px;
        box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    #chat::-webkit-scrollbar {
        width: 8px;
    }

    #chat::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
    }

    #chat::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 10px;
    }

    #chat::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    .input-group input {
        border-radius: 10px;
        border: 2px solid #e0e0e0;
        padding: 12px 15px;
        transition: all 0.3s ease;
    }

    .input-group input:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        outline: none;
    }

    #sendMessage {
        border-radius: 10px;
        padding: 12px 30px;
        font-weight: 600;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    #sendMessage:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    #sendMessage:active {
        transform: translateY(0);
    }

    .message-item {
        padding: 10px 15px;
        margin-bottom: 10px;
        border-radius: 10px;
        background: white;
        border-left: 4px solid #667eea;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .message-sender {
        color: #667eea;
        font-weight: 600;
        margin-right: 8px;
    }

    .message-content {
        color: #333;
    }

    ::placeholder {
        color: #aaa;
        font-style: italic;
    }
  </style>
</head>

<body>
<div class="container mt-5">
  <h1 class="text-center">ðŸ’¬ Real-Time Chat Application</h1>

  <div class="chat-container">
    <div id="chat" class="mb-4" style="height: 350px; overflow-y: auto;">
    </div>

    <div class="input-group mb-3">
      <input id="senderInput" type="text" class="form-control" placeholder="Your name..." />
    </div>

    <div class="input-group mb-3">
      <input id="messageInput" type="text" class="form-control" placeholder="Type a message..." />
      <button id="sendMessage" class="btn btn-primary ms-2">Send</button>
    </div>
  </div>
</div>

<script>
  var stompClient = null;

  function setConnected(connected) {
      document.getElementById('sendMessage').disabled = !connected;
  }

  function connect() {
      var socket = new SockJS('/chat');
      stompClient = Stomp.over(socket);

      stompClient.connect({}, function (frame) {
          console.log('Connected: ' + frame);
          setConnected(true);
          stompClient.subscribe('/topic/messages', function (message) {
              showMessage(JSON.parse(message.body));
          });
      }, function(error) {
          console.log('Connection error: ' + error);
          setConnected(false);
      });
  }

  function showMessage(message) {
      var chat = document.getElementById('chat');
      var messageElement = document.createElement('div');
      messageElement.className = "message-item";

      var senderSpan = document.createElement('span');
      senderSpan.className = "message-sender";
      senderSpan.textContent = message.sender + ':';

      var contentSpan = document.createElement('span');
      contentSpan.className = "message-content";
      contentSpan.textContent = ' ' + message.content;

      messageElement.appendChild(senderSpan);
      messageElement.appendChild(contentSpan);

      chat.appendChild(messageElement);
      chat.scrollTop = chat.scrollHeight;
  }

  function sendMessage() {
      var sender = document.getElementById('senderInput').value;
      var content = document.getElementById('messageInput').value;

      if (!sender || !content) {
          alert('Please enter both name and message');
          return;
      }

      var chatMessage = {
          sender: sender,
          content: content
      };

      stompClient.send("/app/sendMessage", {}, JSON.stringify(chatMessage));
      document.getElementById('messageInput').value = '';
  }


  document.getElementById('sendMessage').addEventListener('click', sendMessage);

  document.getElementById('messageInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
          sendMessage();
      }
  });

  window.onload = connect;
</script>
</body>
</html>